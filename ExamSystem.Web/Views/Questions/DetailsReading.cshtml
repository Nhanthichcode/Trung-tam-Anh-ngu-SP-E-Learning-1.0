@model ExamSystem.Web.Models.ReadingDetailsViewModel

@{
    ViewData["Title"] = "Chi tiết bài đọc";
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h3 class="text-primary"><i class="fa fa-book-open"></i> Chi tiết bài đọc</h3>
        <div>
            <a asp-action="EditReading" asp-route-id="@Model.Questions.FirstOrDefault()?.Id" class="btn btn-warning shadow-sm">
                <i class="fa fa-pencil"></i> Sửa bài này
            </a>
            <a asp-action="Index" class="btn btn-secondary shadow-sm">
                <i class="fa fa-arrow-left"></i> Quay lại
            </a>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-6 mb-4">
            <div class="card border-success shadow-sm h-100">
                <div class="card-header bg-success text-white fw-bold">
                    <i class="fa fa-align-left"></i> Passage Text (Level @Model.Level)
                </div>
                <div class="card-body bg-light">
                    <div style="white-space: pre-wrap; font-family: 'Georgia', serif; line-height: 1.6; color: #333;">@Model.PassageText</div>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <h5 class="text-secondary mb-3">Danh sách câu hỏi (@Model.Questions.Count câu)</h5>

            @foreach (var item in Model.Questions.Select((value, i) => new { i, value }))
            {
                var q = item.value;
                <div class="card mb-3 border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom fw-bold text-primary">
                        Câu hỏi @(item.i + 1)
                    </div>
                    <div class="card-body">
                        <p class="card-text fw-bold">@q.Content</p>

                        @if (q.Answers != null && q.Answers.Any())
                        {
                            <ul class="list-group list-group-flush mb-3">
                                @foreach (var ans in q.Answers)
                                {
                                    <li class="list-group-item @(ans.IsCorrect ? "list-group-item-success" : "")">
                                        @ans.Content

                                        @if (ans.IsCorrect)
                                        {
                                            <i class="fa fa-check float-end"></i>
                                        }
                                    </li>
                                }
                            </ul>
                        }
                        else
                        {
                            <div class="alert alert-warning small">Dữ liệu cũ (Chưa migrate Answers)</div>
                            
                        }

                        @if (!string.IsNullOrEmpty(q.Explaination))
                        {
                            <div class="alert alert-info p-2 small mb-0">
                                <strong><i class="fa fa-info-circle"></i> Giải thích:</strong> @q.Explaination
                            </div>
                        }
                    </div>
                </div>
            }
        </div>
    </div>
</div>